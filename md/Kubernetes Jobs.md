---
tags:
  - devops
  - workload
  - kubernetes
  - "#üü°"
  - –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏
data created: 2024-10-19
---
# –ó–∞–¥–∞–Ω–∏–µ
----
–ß—Ç–æ —Ç–∞–∫–æ–µ job? –∏ –∫–∞–∫ –∏—Ö –∏—Å–æ–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

# –ü–æ–º–µ—Ç–∫–∏ 
---
Jobs - —ç—Ç–æ –ø–æ–¥ –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø–æ –∫–∞–∫–æ–º—É—Ç–æ —Ç—Ä–∏–≥–µ—Ä—É –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø—Ä–æ–ø–∏—Å–∞–Ω–Ω—ã–µ –≤ –Ω–µ–º –∫–æ–º–∞–Ω–¥—ã –ø–æ—Å–ª–µ —á–µ–≥–æ –µ—Å–ª–∏ –≤—Å–µ –ø—Ä–æ—à–ª–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ç–æ —É–¥–∞–ª—è–µ—Ç—Å—è.
```yaml
apiVersion: batch/v1
kind: Job
metadata:
  name: pi
spec:
  template:
    spec:
      containers:
      - name: pi
        image: perl
        command: ["perl",  "-Mbignum=bpi", "-wle", "print bpi(2000)"]
      restartPolicy: Never
```
Job —Å —Å–∞–π—Ç–∞ kubernetes , –∑–¥–µ—Å—å –∑–∞–ø—É—Å–∫–∞–µ—å—Ç—å—Å—è –ø–æ–¥ —Å—á–∏—Ç–∞–µ—Ç —á–∏—Å–ª–æ –ø–∏ –¥–æ 2000 –∑–Ω–∞–∫–∞ –ø–æ—Å–ª–µ —á–µ–≥–æ –ø—Ä–µ–∫—Ä–∞—â–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∏ –∑–∞–Ω–∏–º–∞—Ç—å –º–µ—Å—Ç–æ –≤ kubernetes.

## restart policy 
Job –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å RestartPolicy, –∫–æ—Ç–æ—Ä–æ–µ –º–æ–∂–µ—Ç –±—ã—Ç—å Never –∏–ª–∏ OnFailure.

```yaml
apiVersion: batch/v1
kind: Job
metadata:
  name: job-with-restartpolicy-onfailure
spec:
  backoffLimit: 3
  template:
    spec:
      containers:
      - name: job-with-failure
        image: busybox
        command: ["/bin/sh", "-c"]
        args: ["echo 'Running Job'; sleep 5; exit 1"]
      restartPolicy: OnFailure
```
–í –¥–∞–Ω–Ω–æ–º –ø—Ä–∏–º–µ—Ä–µ –ø–æ–¥ –≤—Å–µ–≥–¥–∞ –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç —Å–≤–æ—é —Ä–∞–±–æ—Ç—É —Å –æ—à–∏–±–∫–æ–π, –∏–∑ –∑–∞ —á–µ–≥–æ kubelet –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç –¥–∞–Ω–Ω—ã–π –ø–æ–¥, –µ—Å–ª–∏ –ø–æ—Å–ª–µ 3 –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–æ–≤ –ø–æ–¥–∞ –≤—Å–µ —Ç–∞–∫ –∂–µ –æ—à–∏–±–∫–∞ —Ç–æ job –ø—Ä–µ–∫—Ä–∞—Ç–∏—Ç —Å–≤–æ—é —Ä–∞–±–æ—Ç—É –∏ job –±—É–¥–µ—Ç —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º Failed –Ω–æ –ø—Ä–∏ —ç—Ç–æ–º –ø–æ–¥–æ–≤ –Ω–µ –æ—Å—Ç–∞–Ω–µ—Ç—Å—è.
```yaml
  backoffLimit: 3
```
–û—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —Ç–æ —Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –ø–æ–¥
```yaml
      restartPolicy: OnFailure
```
—á—Ç–æ –¥–µ–ª–∞—Ç—å –µ—Å–ª–∏ –ø–æ–¥ –≤—ã–¥–∞–µ—Ç –æ—à–∏–±–∫—É
–µ—Å–ª–∏ –∂–µ –ø–æ—Å—Ç–∞–≤–∏—Ç—å –≤–º–µ—Å—Ç–æ `OnFailure` `Never` —Ç–æ –ø–æ–¥—ã –Ω–µ –±—É–¥—É—Ç —É–¥–∞–ª—è—Ç—å—Å—è, –æ–Ω–∏ –±—É–¥—É—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å—Å—è –Ω–æ–≤—ã–µ –ø–æ–∫–∞ –ª–∏–±–æ –ø–æ–¥ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –æ—à–∏–±–∫–∏ –ª–∏–±–æ –Ω–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç–∏–≥–Ω—É—Ç `backoffLimit`, –ø–æ—Å–ª–µ —á–µ–≥–æ –≤—Å–µ –ø–æ–¥—ã –±—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã –∞ Job –±—É–¥–µ—Ç —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º Failed

## –ú–Ω–æ–≥–æ—Ä–∞–∑–æ–≤—ã–π –∑–∞–ø—É—Å–∫
–¢–∞–∫ –∂–µ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —Ç–∞–∫ —á—Ç–æ–±—ã Job –≤—ã–ø–æ–ª–Ω–∏–ª–∞—Å—å n —Ä–∞–∑ –µ—Å–ª–∏
```yaml
---
apiVersion: batch/v1
kind: Job
metadata:
	name: testing-job
spec:
	backoffLimit: 3
	completions: 3
	template:
		spec:
			containers:
			- name: pi
			  image: perl
	          command: ["perl",  "-Mbignum=bpi", "-wle", "print bpi(2000)"]
		    restartPolicy: Never
```
–í –¥–∞–Ω–Ω–æ–º –ø—Ä–∏–º–µ—Ä–µ –º—ã —É—Å—Ç–∞–Ω–æ–≤–∏–ª–∏ `completions` –Ω–∞ 3 —ç—Ç–æ –∑–Ω–∞—á–∏—Ç —á—Ç–æ –Ω–∞—à–∞ job –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø–æ–¥ –∫–æ—Ç–æ—Ä—ã–π –º—ã –æ–ø–∏—Å–∞–ª–∏ 3 —Ä–∞–∑–∞, –∫–∞–∂–¥—ã–π –ø–æ–¥ –ø–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç—Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–µ–¥—ã–¥—É—â–∏–π –ø–æ–¥.

## –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ –ø–æ–¥–æ–≤
–¢–∞–∫–∂–µ –º–æ–∂–Ω–æ —Å–∫–∞–∑–∞—Ç—å —á—Ç–æ–±—ã kubelet –∑–∞–ø—É—Å–∫–∞–ª –ø–æ–¥—ã —É –Ω–∞—à–µ–π Job –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ,
```yaml
---
apiVersion: batch/v1
kind: Job
metdata:
	name: testing-parallelism
spec:
	backoffLimit: 3
	parallelism: 2
	template:
	    spec:
	      containers:
	      - name: pi
	        image: perl
	        command: ["perl",  "-Mbignum=bpi", "-wle", "print bpi(2000)"]
	      restartPolicy: OnFailure
```
–¢–æ –µ—Å—Ç—å –º—ã –≥–æ–≤–æ—Ä–∏–º –∑–∞–ø—É—Å–∫–∞–π –ø–æ 2 –ø–æ–¥–∞ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –±–ª–∞–≥–æ–¥–∞—Ä—è `parallelism`

### –¢–∞–∫ –∂–µ –º–æ–∂–Ω–æ –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞—Ç—å `paralellism` –∏ `completions`

## –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ —Ä–∞–±–æ—Ç—ã job
–ú–æ–∂–Ω–æ –ø—Ä–æ–ø–∏—Å–∞—Ç—å —Å–∫–æ–ª—å–∫–æ –≤—Ä–µ–º–µ–Ω–∏ –¥–æ–ª–∂–Ω–æ –∑–∞–Ω—è—Ç—å –¥–ª—è —Ç–æ–≥–æ —á—Ç–æ–±—ã job –∑–∞–≤–µ—Ä—à–∏–ª —Å–æ–≤—é —Ä–∞–±–æ—Ç—É –∏ —Ç—É—Ç –∏–º–µ–Ω–Ω–æ —Ä–µ—á—å –∏–¥–µ—Ç –Ω–æ –ø—Ä–æ —Ç–æ —Å–∫–æ–ª—å–∫–æ pod –æ—Ç—Ä–∞–±–æ—Ç–∞–µ—Ç –≤—Ä–µ–º–µ–Ω–∏–µ –∞ —Å–∫–æ–ª—å–∫–æ –≤–æ–æ–±—â–µ –¥–æ–ª–∂–Ω–∞ –æ—Ç—Ä–∞–±–æ—Ç–∞—Ç—å –¥–∂–æ–±–∞ 
```yaml
apiVersion: batch/v1
kind: Job
metadata:
  name: job-with-failure
spec:
  backoffLimit: 4
  activeDeadlineSeconds: 50
  template:
    spec:
      containers:
      - name: job-with-failure
        image: busybox
        command: ["/bin/sh", "-c"]
        args: ["echo 'Running Job'; sleep 5; exit 1"]
      restartPolicy: Never
```
–¢–æ–µ—Å—Ç—å –≤ –¥–∞–Ω–Ω–æ–º –ø—Ä–∏–º–µ—Ä–µ –º—ã —É—Å—Ç–∞–Ω–æ–≤–∏–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä `activeDeadlineSeconds` –Ω–∞ 50 –∏ —ç—Ç–æ –∑–Ω–∞—á–∏—Ç —á—Ç–æ –µ—Å–ª–∏ Job –Ω–µ —É—Å–ø–µ–µ—Ç –∑–∞–≤–µ—Ä—à–∏—Ç—å —Å–≤–æ—é —Ä–∞–±–æ—Ç—É –ø–æ—Å–ª–µ 50 —Å–µ–∫—É–Ω–¥ —Ç–æ —Å–∞–º–∞ Job –±—É–¥–µ—Ç –≤–∏—Å–µ—Ç—å –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ `Failed`



# –í—ã–≤–æ–¥—ã

---
‚è≤19.10.2024 –ù–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –¥—É–º–∞—é —ç—Ç–æ —Ç–æ —á—Ç–æ –Ω—É–∂–Ω–æ —Å–Ω–∞—á–∞–ª–∞ –ø–µ—Ä–µ–≤–∞—Ä–∏—Ç—å —Ç–∞–∫ –∫–∞–∫ —É job –µ—Å—Ç—å –µ—â–µ –∫—É—á–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ 
